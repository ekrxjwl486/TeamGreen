<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Moim">

	<insert id="inputMoim">
    	INSERT INTO MOIM( MOIM_IDX, MOIM_NAME, UNIVNAME, MOIM_CATE, USER_ID, MOIM_INTRO)
    	VALUES ( (SELECT NVL(MAX(MOIM_IDX)+1,0) FROM MOIM) ,
    			#{moim_name},
    			#{univname},
    			#{moim_cate},
    			#{user_id},
    			#{moim_intro})
	</insert>
  
	<select id="MoimList"
	      resultType="com.green.moim.vo.MoimVo">
	      SELECT MOIM.MOIM_IDX,
	      		 MOIM.MOIM_NAME,
				 MOIM.UNIVNAME,
	      		 MOIM.MOIM_CATE,
				 MOIM.USER_ID,
				 MOIM.MOIM_INTRO,
                 MUSER.USER_NAME,
                 MUSER.USER_CATE
		  FROM	MOIM,MUSER
          WHERE MOIM.UNIVNAME=MUSER.UNIVNAME
          AND   INSTR(MUSER.USER_CATE,MOIM.MOIM_CATE)>0
		  ORDER BY MOIM_IDX ASC
	
	</select>
  
  
	 <!--KHT_모임정보 가져오기(com.green.moim.vo.MoimVo) -->
	<select id="Getmoim" resultType="com.green.moim.vo.MoimVo">
	    SELECT  moim.moim_idx, moim.moim_name, moim.moim_cate, moim.user_id, moim.moim_intro, moim.univname, muser.user_name
	      FROM  moim, muser
	     WHERE  moim_idx = #{moim_idx}
	       AND  moim.user_id = muser.user_id
	</select>
 
 	<select id="MoimInfo"
		resultType="com.green.moim.vo.MoimVo">
		SELECT  MOIM_IDX, MOIM_NAME, MOIM_CATE, USER_ID, MOIM_INTRO
		FROM    MOIM
		WHERE   MOIM_IDX = #{moim_idx}
		
	</select>
	
	
	<select id="Search_moim_name"
   		resultType="com.green.moim.vo.MoimVo">
   		SELECT  MOIM_NAME, MOIM_CATE, MOIM_INTRO
		FROM    MOIM
		WHERE   MOIM_NAME LIKE '%'||#{search_moim_name}||'%'
		OR      MOIM_CATE LIKE '%'||#{search_moim_name}||'%'
   		
    </select>
 
      
</mapper>














